---
title: "数据预处理"
author: "熊凌峰 20222201752 黄赫堂 2020201415"
date: "2024-12-18"
output: 
  rmdformats::readthedown:
    self_contained: true
    thumbnails: false
    lightbox: true
    gallery: false
    highlight: tango
---

# 数据预处理

## 加载必要的包

```{r}
library(tidyverse)
library(readxl)
library(writexl)
library(dplyr)
```

## 读取原始数据

```{r}
# 读取原始数据
data_raw <- read_excel("data_origin.xlsx")
head(data_raw)
```

## 年薪对数化处理

为了改善数据分布的偏态性,对年薪进行对数变换:

```{r}
# 对年薪进行对数变换
data_raw <- data_raw %>%
  mutate(log_salary = log(年薪))

# 查看转换后的基本统计信息
summary(data_raw$log_salary)
```

## 更改职业、地区类别、公司行业与融资阶段
```{r}
data_raw <- data_raw %>%
  mutate(职业类别 = case_when(
    职业类别 %in% c("技术与工程类", "商务与管理类") ~ "商务与工程类",
    职业类别 %in% c("媒体与创意类", "教育与培训类") ~ "媒体与培训类",
    职业类别 %in% c("销售与市场类", "服务与支持类") ~ "销售与服务类",
    TRUE ~ 职业类别
  ))
```

```{r}
data_raw <- data_raw %>%
  mutate(位置 = case_when(
    位置 %in% c("北京", "天津", "上海", "江苏", "浙江", "山东", "福建", "台湾") ~ "东部地区",
    位置 %in% c("湖北", "湖南", "安徽", "江西", "河北", "内蒙古", "河南", "山西") ~ "中部地区",
    位置 %in% c("新疆", "西藏", "青海", "四川", "云南", "陕西", "重庆", "甘肃", "宁夏") ~ "西部地区",
    位置 %in% c("贵州", "广西", "广东", "深圳", "海南") ~ "南部地区",
    位置 %in% c("黑龙江", "吉林", "辽宁") ~ "东北地区",
    TRUE ~ "南部地区"
  ))
```

```{r}
data_raw <- data_raw %>%
  mutate(公司行业 = case_when(
    公司行业 %in% c("互联网/IT/电子/通信", "金融") ~ "金融互联网",
    公司行业 %in% c("广告/传媒/文化/体育", "教育培训") ~ "媒体教培",
    公司行业 %in% c("制药/医疗", "交通/物流/贸易/零售", "政府/非盈利机构/其他", "能源/化工/环保") ~ "公共服务",
    公司行业 %in% c("专业服务", "房地产/建筑", "服务业", "消费品") ~ "商业服务",
    公司行业 %in% c("汽车", "机械/制造") ~ "机械制造",
    TRUE ~ 公司行业
  ))
```

```{r}
data_raw <- data_raw %>%
  mutate(融资阶段 = case_when(
    融资阶段 %in% c("A轮", "B轮", "C轮", "D轮及以上") ~ "正在融资",
    融资阶段 %in% c("天使轮", "未融资") ~ "准备融资",
    TRUE ~ 融资阶段
  ))
```

## 保存处理后的数据

```{r}
# 保存处理后的数据
write_xlsx(data_raw, "data.xlsx")
```

数据预处理完成。主要进行了以下操作:
1. 读取原始Excel数据
2. 对年薪进行对数变换,改善分布偏态性
3. 保存处理后的数据到CSV文件,供后续分析使用
